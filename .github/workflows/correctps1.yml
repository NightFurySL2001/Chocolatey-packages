name: Correct PS1

on:
  schedule:
    - cron:  '4 4 * * *'
  push:
    branches:
      master
  workflow_dispatch:
  

jobs:
  clean_ps1:
    runs-on: windows-latest
    defaults:
      run:
        shell: powershell
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 100
      - name: Check a build environment
        run: |
          Get-CimInstance win32_operatingsystem -Property Caption, OSArchitecture, Version | fl Caption, OSArchitecture, Version
          $PSVersionTable
          git --version
          choco --version
          cmd /c "set" | grep -i 'github\|runner' | sort
      - name: Initialize Git config
        run: |
          git config --global user.email "helpdesk.choc@gmail.com"
          git config --global user.name "Tunisiano187"
          git config --global core.safecrlf false
      - name: Correct PS1 files
        run: |
          scripts/global/Update-variables.ps1
        env:
          github_user_repo: ${{ github.repository }}
          github_api_key: ${{ secrets.AU_GITHUB_API_KEY }}